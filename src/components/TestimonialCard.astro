---
import { Image } from 'astro:assets';

interface Props {
  name: string;
  title: string;
  testimonial: string;
  photoUrl?: string;
  link?: string;
  linkTooltip?: string; // Add tooltip prop
  index?: number; // Add index prop to determine color
}

const { name, title, testimonial, photoUrl, link, linkTooltip, index = 0 } = Astro.props;

// Get first letter for avatar fallback
const initial = name.charAt(0).toUpperCase();

// Simple array of colors to cycle through
const avatarColors = [
  'bg-blue-500',    // Blue
  'bg-red-500',     // Red  
  'bg-green-500'    // Green
];

// Get color based on index
const avatarColor = avatarColors[index % avatarColors.length];
---

<div class="bg-secondary-900/50 backdrop-blur-sm border border-secondary-800 rounded-lg p-6">
  <div class="flex items-center mb-4">
    {link ? (
      <a 
        href={link} 
        target="_blank" 
        rel="noopener noreferrer"
        class="mr-4 transition-transform duration-200 hover:scale-105"
        title={linkTooltip}
      >
        {photoUrl ? (
          <Image 
            src={photoUrl}
            alt={name}
            width={48}
            height={48}
            class="w-12 h-12 rounded-full object-cover"
          />
        ) : (
          <div class={`w-12 h-12 ${avatarColor} rounded-full flex items-center justify-center font-bold text-xl text-white`}>
            {initial}
          </div>
        )}
      </a>
    ) : (
      photoUrl ? (
        <Image 
          src={photoUrl}
          alt={name}
          width={48}
          height={48}
          class="w-12 h-12 rounded-full object-cover mr-4"
        />
      ) : (
        <div class={`w-12 h-12 ${avatarColor} rounded-full flex items-center justify-center font-bold text-xl mr-4 text-white`}>
          {initial}
        </div>
      )
    )}
    <div>
      {link ? (
        <a 
          href={link} 
          target="_blank" 
          rel="noopener noreferrer"
          class="text-white font-semibold hover:text-accent-400 transition-colors duration-200 inline-flex items-center gap-1"
          title={linkTooltip}
        >
          {name}
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-60">
            <line x1="7" y1="17" x2="17" y2="7"></line>
            <polyline points="7 7 17 7 17 17"></polyline>
          </svg>
        </a>
      ) : (
        <h4 class="text-white font-semibold">{name}</h4>
      )}
      <p class="text-secondary-400 text-sm">{title}</p>
    </div>
  </div>
  <p class="text-secondary-300 font-body">
    {testimonial}
  </p>
</div>